<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Updated App Header -->
    <title>PE Option Sell Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc;
        }
        .card {
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            border-radius: 1rem;
        }
        /* Custom colors for legend */
        .legend-green { background-color: #10b981; color: white; }
        .legend-amber { background-color: #f59e0b; color: white; }
        .legend-red { background-color: #ef4444; color: white; }
    </style>
</head>
<body class="p-4 sm:p-8 min-h-screen flex items-center justify-center">

    <div class="w-full max-w-lg bg-white p-6 sm:p-8 card border border-gray-200">
        <!-- Updated App Header -->
        <h1 class="text-3xl font-extrabold text-gray-900 mb-6 text-center">PE Option Sell Analyzer</h1>
        
        <!-- Input Fields -->
        <div class="space-y-4">
            
            <!-- Ticker Dropdown -->
            <div>
                <label for="ticker" class="block text-sm font-medium text-gray-700">Ticker</label>
                <select id="ticker" name="ticker" required class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                    <option value="" disabled selected>Select a Ticker</option>
                    {% for ticker in tickers %}
                        <option value="{{ ticker }}">{{ ticker }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Quantity (Auto-populated from Ticker) -->
            <div>
                <label for="quantity" class="block text-sm font-medium text-gray-700">Quantity</label>
                <input type="number" id="quantity" name="quantity" required 
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-gray-100" 
                       value="0" readonly>
            </div>
            
            <!-- Strike Price -->
            <div>
                <label for="strike-price" class="block text-sm font-medium text-gray-700">Strike Price</label>
                <input type="number" id="strike-price" name="strike-price" required step="0.01" value="0"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
            </div>

            <!-- Premium Paid/Received (Moved up, Label changed) -->
            <div>
                <label for="premium" class="block text-sm font-medium text-gray-700">Premium (Rs.) - per Quantity</label>
                <input type="number" id="premium" name="premium" required step="0.01" value="0"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
            </div>

            <!-- Funds Req (Rs.) - New editable input field (Default: 100000) -->
            <div>
                <label for="fund-req" class="block text-sm font-medium text-gray-700">Funds Req (Rs.)</label>
                <!-- NOTE: Type is 'text' to allow custom Indian comma formatting via JavaScript -->
                <input type="text" id="fund-req" name="fund-req" required value="100000"
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm text-right"
                       inputmode="numeric" pattern="[0-9,]*">
            </div>

            <!-- Expiry Date (Moved down) -->
            <div>
                <label for="expiry-date" class="block text-sm font-medium text-gray-700">Expiry Date</label>
                <input type="date" id="expiry-date" name="expiry-date" required
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
            </div>

        </div>

        <hr class="my-8 border-t border-gray-200">
        
        <!-- Output: Current Market Price (Moved above Trade Analysis) -->
        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg mb-4">
            <span class="text-sm font-medium text-gray-700">Current Market Price:</span>
            <span id="market-price" class="text-lg font-bold text-blue-600">--</span>
        </div>

        <!-- Output: 50 DMA Percentage (Moved above Trade Analysis) -->
        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg mb-4">
            <span class="text-sm font-medium text-gray-700">50 DMA (% of CMP):</span>
            <span id="dma50-percent" class="text-lg font-bold text-gray-800">--</span>
        </div>
        
        <!-- Output & Results -->
        <h2 class="text-xl font-bold text-gray-900 mb-4 text-center">Trade Analysis</h2>

        <div class="space-y-4">
            
            <!-- Days To Expiry (DTE) -->
            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                <span class="text-sm font-medium text-gray-700">Days To Expiry (DTE):</span>
                <span id="dte" class="text-lg font-bold px-3 py-1 rounded-full">--</span>
            </div>
            
            <!-- ROI at Expiry -->
            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                <span class="text-sm font-medium text-gray-700">ROI % per week:</span>
                <span id="roi" class="text-lg font-bold px-3 py-1 rounded-full">--</span>
            </div>
            
            <!-- Delta % -->
            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                <span class="text-sm font-medium text-gray-700">Price Delta %:</span>
                <span id="delta" class="text-lg font-bold px-3 py-1 rounded-full">--</span>
	    </div>

        </div>
    </div>

    <!-- Link to the front-end logic -->
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>